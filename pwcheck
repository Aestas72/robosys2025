#!/usr/bin/python3
# SPDX-FileCopyrightText: 2025 Natsuhi Shimada
# SPDX-License-Identifier: BSD-3-Clause

import sys
import re


weak_passwords = ["password", "1234", "asd", "1111", "picture1", "aaa"]

def check_strength(pw):
    score = 0
    issues = []

    if len(pw) >= 8:
        score += 1
    else:
        issues.append("8文字未満")

    if re.search(r"[a-z]", pw):
        score += 1
    else:
        issues.append("小文字が含まれていません")

    if re.search(r"[A-Z]", pw):
        score += 1
    else:
        issues.append("大文字が含まれていません")

    if re.search(r"\d", pw):
        score += 1
    else:
        issues.append("数字が含まれていません")

    if re.search(r"[^A-Za-z0-9]", pw):
        score += 1
    else:
        issues.append("記号が含まれていません")

    if any(w in pw.lower() for w in weak_passwords):
        issues.append("よくある弱い単語が含まれています")

    return score, issues

first_input = True
for line in sys.stdin:
    pw = line.strip()

    if pw == "":
        print("エラー: 空の入力は無効です", file=sys.stderr)
        sys.exit(1)

    if pw == "" and not first_input:
        print("エラー: 空の入力は無効です", file=sys.stderr)
        sys.exit(1)

    first_input = False

    score, issues = check_strength(pw)

    print(f"{score}/5")

    if issues:
        print("問題点:")
        for i in issues:
            print(" -", i)
    
    print()

